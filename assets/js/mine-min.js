var grid=document.getElementById("mine-grid"),width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,grid_size=width<"601"?"5":"10",num_mines="10"===grid_size?"20":"5",game_active=!0;const refresh=document.querySelector(".refresh");function generateGrid(){grid.innerHTML="";for(var e=0;e<grid_size;e++){row=grid.insertRow(e);for(var i=0;i<grid_size;i++){cell=row.insertCell(i),cell.addEventListener("contextmenu",(function(e){return e.preventDefault(),righClickCell(this),!1}),!1),cell.addEventListener("click",(function(){clickCell(this)}));var r=document.createAttribute("data-mine");r.value="false",cell.setAttributeNode(r)}}addMines(),game_active=!0}function addMines(){for(var e=0;e<num_mines;e++){var i=Math.floor(Math.random()*grid_size),r=Math.floor(Math.random()*grid_size);grid.rows[i].cells[r].setAttribute("data-mine","true")}}function revealMines(){for(var e=0;e<grid_size;e++)for(var i=0;i<grid_size;i++){var r=grid.rows[e].cells[i];"true"==r.getAttribute("data-mine")&&(r.className="mine")}game_active=!1}function checkLevelCompletion(){for(var e=!0,i=0;i<grid_size;i++)for(var r=0;r<grid_size;r++)"false"==grid.rows[i].cells[r].getAttribute("data-mine")&&""==grid.rows[i].cells[r].innerHTML&&(e=!1);e&&revealMines()}function rightClickCell(e){e.className="right-clicked"}function clickCell(e){if("true"==e.getAttribute("data-mine"))revealMines();else if(0!=game_active){e.className="clicked";for(var i=0,r=e.parentNode.rowIndex,t=e.cellIndex,n=Math.max(r-1,0);n<=Math.min(r+1,grid_size-1);n++)for(var a=Math.max(t-1,0);a<=Math.min(t+1,grid_size-1);a++)"true"==grid.rows[n].cells[a].getAttribute("data-mine")&&i++;if(e.innerHTML=i,0==i)for(n=Math.max(r-1,0);n<=Math.min(r+1,grid_size-1);n++)for(a=Math.max(t-1,0);a<=Math.min(t+1,grid_size-1);a++)""==grid.rows[n].cells[a].innerHTML&&clickCell(grid.rows[n].cells[a]);checkLevelCompletion()}}function main(){generateGrid(),refresh.addEventListener("click",generateGrid)}main();